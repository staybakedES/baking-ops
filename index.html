<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bakery Order Board</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7fafc;
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <!-- Load React and ReactDOM from CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Load Babel to transpile JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Load Firebase libraries from CDN and expose them to the global scope -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
        import { getAuth, signInWithCustomToken, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-auth.js";
        import { getFirestore, collection, addDoc, doc, updateDoc, deleteDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore.js";

        // This script block will be executed once and provides the global variables needed for the React app
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Expose Firebase instances and functions to the global window object so the React script can access them
        window.firebaseApp = app;
        window.firebaseAuth = auth;
        window.firebaseDb = db;
        window.firebaseAuthToken = initialAuthToken;
        window.firebaseAppId = appId;
        window.initializeApp = initializeApp;
        window.getAuth = getAuth;
        window.getFirestore = getFirestore;
        window.signInWithCustomToken = signInWithCustomToken;
        window.signInAnonymously = signInAnonymously;
        window.onAuthStateChanged = onAuthStateChanged;
        window.collection = collection;
        window.addDoc = addDoc;
        window.doc = doc;
        window.updateDoc = updateDoc;
        window.deleteDoc = deleteDoc;
        window.onSnapshot = onSnapshot;

        // Sign in the user. We must do this before any Firestore operations.
        const signIn = async () => {
            try {
                if (initialAuthToken) {
                    await window.signInWithCustomToken(auth, initialAuthToken);
                } else {
                    await window.signInAnonymously(auth);
                }
                console.log("Firebase authentication successful.");
            } catch (error) {
                console.error("Firebase authentication error:", error);
            }
        };
        signIn();
    </script>

    <script type="text/babel">
        // All of the React components are defined within this script block.
        // This makes the code self-contained and ready to run.
        const { useState, useEffect } = React;

        // Main App component
        const App = () => {
          const [db, setDb] = useState(null);
          const [user, setUser] = useState(null);
          const [appId, setAppId] = useState(null);
          const [isAuthReady, setIsAuthReady] = useState(false);
          const [orders, setOrders] = useState([]);
          const [bakerName, setBakerName] = useState('');
          const [showAddOrderModal, setShowAddOrderModal] = useState(false);
          const [showOrderDetailsModal, setShowOrderDetailsModal] = useState(false);
          const [selectedOrder, setSelectedOrder] = useState(null);
          const [showCustomModal, setShowCustomModal] = useState(false);
          const [customModalMessage, setCustomModalMessage] = useState('');
          const [showConfirmModal, setShowConfirmModal] = useState(false);
          const [confirmAction, setConfirmAction] = useState(null);

          // This useEffect handles the full Firebase initialization and authentication
          useEffect(() => {
            // Wait for Firebase to be initialized and exposed to the window
            if (window.firebaseApp && window.firebaseAuth && window.firebaseDb) {
              setDb(window.firebaseDb);
              setAppId(window.firebaseAppId);

              // Set up an auth state listener to get the user object
              const unsubscribeAuth = window.onAuthStateChanged(window.firebaseAuth, (authUser) => {
                if (authUser) {
                  setUser(authUser);
                } else {
                  setUser(null);
                }
                setIsAuthReady(true);
              });
              
              return () => unsubscribeAuth();
            }
          }, []);

          // This useEffect listens for orders, but only after authentication is ready
          useEffect(() => {
              let unsubscribeOrders = () => {};
              if (isAuthReady && user && db && appId) {
                  const ordersColRef = window.collection(db, `artifacts/${appId}/public/data/orders`);
                  unsubscribeOrders = window.onSnapshot(ordersColRef, (snapshot) => {
                      const ordersData = snapshot.docs.map(orderDoc => ({
                          id: orderDoc.id,
                          ...orderDoc.data(),
                      }));
                      setOrders(ordersData);
                  }, (error) => {
                      console.error("Error fetching orders:", error);
                      setCustomModalMessage(`Error fetching orders: ${error.message}`);
                      setShowCustomModal(true);
                  });
              }
              return () => unsubscribeOrders();
          }, [isAuthReady, user, db, appId]);


          // Function to add a new order and its tasks
          const handleAddOrder = async (orderData, tasks) => {
            if (!db || !user || !appId) {
              setCustomModalMessage("Database or user authentication not ready. Please try again.");
              setShowCustomModal(true);
              return;
            }
            try {
              console.log("Attempting to add new order...");
              const taskObjects = tasks.filter(task => task.trim() !== '').map(taskName => ({
                taskName,
                status: 'New',
                assignedBaker: '',
                id: crypto.randomUUID()
              }));
              
              if (taskObjects.length === 0) {
                 setCustomModalMessage("Please add at least one task.");
                 setShowCustomModal(true);
                 return;
              }

              const ordersColRef = window.collection(db, `artifacts/${appId}/public/data/orders`);
              await window.addDoc(ordersColRef, {
                ...orderData,
                tasks: taskObjects,
                createdAt: new Date().toISOString(),
                userId: user.uid,
              });
              setShowAddOrderModal(false);
            } catch (e) {
              console.error("Error adding document: ", e);
              setCustomModalMessage(`Error adding order: ${e.message}`);
              setShowCustomModal(true);
            }
          };

          // Function to update a task's status and assigned baker
          const handleUpdateTask = async (orderId, taskId, newStatus, assignedBaker) => {
            if (!db || !appId) {
              setCustomModalMessage("Database not initialized. Please try again.");
              setShowCustomModal(true);
              return;
            }
            try {
              const orderRef = window.doc(db, `artifacts/${appId}/public/data/orders`, orderId);
              const orderToUpdate = orders.find(order => order.id === orderId);
              if (!orderToUpdate) {
                console.error("Order not found for update.");
                return;
              }
              const updatedTasks = orderToUpdate.tasks.map(task => {
                if (task.id === taskId) {
                  return {
                    ...task,
                    status: newStatus,
                    assignedBaker: assignedBaker
                  };
                }
                return task;
              });
              await window.updateDoc(orderRef, { tasks: updatedTasks });
            } catch (e) {
              console.error("Error updating task: ", e);
              setCustomModalMessage(`Error updating task: ${e.message}`);
              setShowCustomModal(true);
            }
          };

          // Function to delete an order
          const handleDeleteOrder = async (orderId) => {
            if (!db || !appId) {
              setCustomModalMessage("Database not initialized. Please try again.");
              setShowCustomModal(true);
              return;
            }
            try {
              const orderRef = window.doc(db, `artifacts/${appId}/public/data/orders`, orderId);
              await window.deleteDoc(orderRef);
              setShowConfirmModal(false);
            } catch (e) {
              console.error("Error deleting order: ", e);
              setCustomModalMessage(`Error deleting order: ${e.message}`);
              setShowCustomModal(true);
            }
          };

          // Loading state handler
          if (!isAuthReady) {
            return (
              <div className="flex items-center justify-center min-h-screen bg-gray-100 dark:bg-gray-900">
                <div className="p-8 bg-white dark:bg-gray-800 rounded-lg shadow-md text-center">
                  <svg className="animate-spin h-10 w-10 text-rose-500 mx-auto" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle className="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" strokeWidth="4"></circle>
                    <path className="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.08 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                  </svg>
                  <p className="mt-4 text-gray-700 dark:text-gray-300">Setting up the bakery...</p>
                </div>
              </div>
            );
          }

          return (
            <div className="min-h-screen bg-gray-50 text-gray-900 dark:bg-gray-950 dark:text-gray-50 p-4 font-sans">
              <div className="max-w-7xl mx-auto py-8 px-4 sm:px-6 lg:px-8">
                <div className="flex items-center justify-between flex-wrap mb-6">
                  <h1 className="text-3xl sm:text-4xl font-extrabold text-rose-600 dark:text-rose-400">
                    Bakery Order Board
                  </h1>
                  <div className="mt-4 sm:mt-0 flex items-center space-x-4">
                    <span className="text-sm text-gray-500 dark:text-gray-400 truncate">
                      Your User ID: {user ? user.uid : 'Loading...'}
                    </span>
                    <button
                      onClick={() => setShowAddOrderModal(true)}
                      className="bg-rose-500 hover:bg-rose-600 text-white font-bold py-2 px-4 rounded-full shadow-lg transform transition duration-200 hover:scale-105"
                    >
                      <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5 inline-block mr-2" viewBox="0 0 20 20" fill="currentColor">
                        <path fillRule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clipRule="evenodd" />
                      </svg>
                      Add New Order
                    </button>
                  </div>
                </div>

                {/* Baker Name Input */}
                <div className="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-4 mb-8">
                  <label htmlFor="bakerName" className="block text-sm font-medium text-gray-700 dark:text-gray-300">
                    Enter Your Name (for assigning tasks):
                  </label>
                  <input
                    type="text"
                    id="bakerName"
                    value={bakerName}
                    onChange={(e) => setBakerName(e.target.value)}
                    className="mt-1 block w-full px-3 py-2 bg-gray-100 dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-rose-500 focus:border-rose-500 sm:text-sm"
                    placeholder="e.g., Jane Doe"
                  />
                </div>

                {/* Main Orders Grid */}
                <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                  {orders.length === 0 ? (
                    <p className="col-span-full text-center text-gray-500 dark:text-gray-400 py-12">
                      No orders yet. Add your first order to get started!
                    </p>
                  ) : (
                    orders.map((order) => (
                      <OrderCard
                        key={order.id}
                        order={order}
                        onDelete={() => {
                            setConfirmAction(() => () => handleDeleteOrder(order.id));
                            setCustomModalMessage("Are you sure you want to delete this order? This action cannot be undone.");
                            setShowConfirmModal(true);
                        }}
                        onSelect={() => {
                          setSelectedOrder(order);
                          setShowOrderDetailsModal(true);
                        }}
                      />
                    ))
                  )}
                </div>
              </div>

              {/* Add Order Modal */}
              {showAddOrderModal && (
                <Modal onClose={() => setShowAddOrderModal(false)}>
                  <AddOrderForm onAddOrder={handleAddOrder} />
                </Modal>
              )}

              {/* Order Details Modal */}
              {showOrderDetailsModal && selectedOrder && (
                <Modal onClose={() => setShowOrderDetailsModal(false)}>
                  <OrderDetails
                    order={selectedOrder}
                    bakerName={bakerName}
                    onUpdateTask={handleUpdateTask}
                  />
                </Modal>
              )}

              {/* Custom Alert/Message Modal */}
              {showCustomModal && (
                <Modal onClose={() => setShowCustomModal(false)}>
                  <div className="p-6 text-center">
                    <p className="text-xl font-semibold text-gray-800 dark:text-gray-200">{customModalMessage}</p>
                    <button
                      onClick={() => setShowCustomModal(false)}
                      className="mt-6 bg-rose-500 hover:bg-rose-600 text-white font-bold py-2 px-4 rounded-full shadow-lg transition duration-200"
                    >
                      OK
                    </button>
                  </div>
                </Modal>
              )}
              
              {/* Custom Confirmation Modal */}
              {showConfirmModal && (
                <Modal onClose={() => setShowConfirmModal(false)}>
                  <div className="p-6 text-center">
                    <p className="text-xl font-semibold text-gray-800 dark:text-gray-200">{customModalMessage}</p>
                    <div className="mt-6 flex justify-center space-x-4">
                      <button
                        onClick={() => {
                          if (confirmAction) {
                            confirmAction();
                          }
                        }}
                        className="bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-full shadow-lg transition duration-200"
                      >
                        Delete
                      </button>
                      <button
                        onClick={() => setShowConfirmModal(false)}
                        className="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-full shadow-lg transition duration-200"
                      >
                        Cancel
                      </button>
                    </div>
                  </div>
                </Modal>
              )}
            </div>
          );
        };

        // Order Card Component
        const OrderCard = ({ order, onDelete, onSelect }) => {
          const completedTasks = (order.tasks || []).filter(task => task.status === 'Completed').length;
          const totalTasks = (order.tasks || []).length;
          const progress = totalTasks > 0 ? (completedTasks / totalTasks) * 100 : 0;
          
          const getProgressColor = () => {
            if (progress === 100) return 'bg-green-500';
            if (progress > 0) return 'bg-yellow-500';
            return 'bg-gray-400';
          };

          return (
            <div className="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 border border-gray-200 dark:border-gray-700 transition-transform duration-200 hover:scale-105 cursor-pointer flex flex-col justify-between">
              <div>
                <h2 className="text-2xl font-bold text-rose-600 dark:text-rose-400 truncate">{order.customerName || 'No Name'}</h2>
                <p className="text-sm text-gray-500 dark:text-gray-400 mt-1">Due: {new Date(order.dueDate).toLocaleDateString()} at {order.dueTime}</p>
                <p className="text-sm font-medium text-gray-600 dark:text-gray-400 mt-2">
                  Tasks Completed: {completedTasks}/{totalTasks}
                </p>
              </div>

              <div className="mt-4 w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700">
                <div className={`h-2.5 rounded-full ${getProgressColor()}`} style={{ width: `${progress}%` }}></div>
              </div>
              
              <div className="flex space-x-2 mt-4">
                <button
                  onClick={(e) => {
                    e.stopPropagation();
                    onSelect();
                  }}
                  className="flex-1 bg-sky-500 hover:bg-sky-600 text-white font-bold py-2 px-4 rounded-full shadow-md transition duration-200"
                >
                  View Tasks
                </button>
                <button
                  onClick={(e) => {
                    e.stopPropagation();
                    onDelete();
                  }}
                  className="bg-gray-400 hover:bg-gray-500 text-white font-bold py-2 px-4 rounded-full shadow-md transition duration-200"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                    <path fillRule="evenodd" d="M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z" clipRule="evenodd" />
                  </svg>
                </button>
              </div>
            </div>
          );
        };

        // Add Order Form Component
        const AddOrderForm = ({ onAddOrder }) => {
          const [customerName, setCustomerName] = useState('');
          const [dueDate, setDueDate] = useState('');
          const [dueTime, setDueTime] = useState('');
          const [tasks, setTasks] = useState(['']);
          const [showCustomModal, setShowCustomModal] = useState(false);
          const [customModalMessage, setCustomModalMessage] = useState('');

          const handleTaskChange = (index, value) => {
            const newTasks = [...tasks];
            newTasks[index] = value;
            setTasks(newTasks);
          };

          const handleAddTask = () => {
            setTasks([...tasks, '']);
          };

          const handleRemoveTask = (index) => {
            const newTasks = tasks.filter((_, i) => i !== index);
            setTasks(newTasks);
          };

          const handleSubmit = (e) => {
            e.preventDefault();
            const filteredTasks = tasks.filter(task => task.trim() !== '');
            if (!customerName || !dueDate || !dueTime || filteredTasks.length === 0) {
              setCustomModalMessage("Please fill in all order details and add at least one task.");
              setShowCustomModal(true);
              return;
            }
            onAddOrder({ customerName, dueDate, dueTime }, filteredTasks);
          };

          return (
            <form onSubmit={handleSubmit} className="p-6">
              <h3 className="text-2xl font-bold text-gray-800 dark:text-gray-200 mb-6">Create New Order</h3>
              <div className="space-y-4">
                <div>
                  <label htmlFor="customerName" className="block text-sm font-medium text-gray-700 dark:text-gray-300">Customer Name</label>
                  <input
                    type="text"
                    id="customerName"
                    value={customerName}
                    onChange={(e) => setCustomerName(e.target.value)}
                    className="mt-1 block w-full px-3 py-2 bg-gray-100 dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-rose-500 focus:border-rose-500"
                    placeholder="e.g., Jane Smith"
                  />
                </div>
                <div>
                  <label htmlFor="dueDate" className="block text-sm font-medium text-gray-700 dark:text-gray-300">Due Date</label>
                  <input
                    type="date"
                    id="dueDate"
                    value={dueDate}
                    onChange={(e) => setDueDate(e.target.value)}
                    className="mt-1 block w-full px-3 py-2 bg-gray-100 dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-rose-500 focus:border-rose-500"
                  />
                </div>
                <div>
                  <label htmlFor="dueTime" className="block text-sm font-medium text-gray-700 dark:text-gray-300">Due Time</label>
                  <input
                    type="time"
                    id="dueTime"
                    value={dueTime}
                    onChange={(e) => setDueTime(e.target.value)}
                    className="mt-1 block w-full px-3 py-2 bg-gray-100 dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-rose-500 focus:border-rose-500"
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium text-gray-700 dark:text-gray-300">Tasks</label>
                  {tasks.map((task, index) => (
                    <div key={index} className="flex items-center mt-2">
                      <input
                        type="text"
                        value={task}
                        onChange={(e) => handleTaskChange(index, e.target.value)}
                        className="flex-1 px-3 py-2 bg-gray-100 dark:bg-gray-900 border border-gray-300 dark:border-gray-700 rounded-md shadow-sm focus:outline-none focus:ring-rose-500 focus:border-rose-500"
                        placeholder="e.g., Bake 2 dozen vanilla cupcakes"
                      />
                      <button
                        type="button"
                        onClick={() => handleRemoveTask(index)}
                        className="ml-2 text-red-500 hover:text-red-700"
                      >
                        <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 7l-.867 12.142A2 2 0 0116.035 21H7.965a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                        </svg>
                      </button>
                    </div>
                  ))}
                  <button
                    type="button"
                    onClick={handleAddTask}
                    className="mt-2 text-rose-500 hover:text-rose-700 flex items-center"
                  >
                    <svg xmlns="http://www.w3.org/2000/svg" className="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                      <path fillRule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clipRule="evenodd" />
                    </svg>
                    Add another task
                  </button>
                </div>
              </div>
              <div className="mt-6 flex justify-end">
                <button
                  type="submit"
                  className="bg-rose-500 hover:bg-rose-600 text-white font-bold py-2 px-4 rounded-full shadow-lg transition duration-200"
                >
                  Add Order
                </button>
              </div>
               {/* Custom Alert/Message Modal for AddOrderForm */}
              {showCustomModal && (
                <Modal onClose={() => setShowCustomModal(false)}>
                  <div className="p-6 text-center">
                    <p className="text-xl font-semibold text-gray-800 dark:text-gray-200">{customModalMessage}</p>
                    <button
                      onClick={() => setShowCustomModal(false)}
                      className="mt-6 bg-rose-500 hover:bg-rose-600 text-white font-bold py-2 px-4 rounded-full shadow-lg transition duration-200"
                    >
                      OK
                    </button>
                  </div>
                </Modal>
              )}
            </form>
          );
        };

        // Order Details Component (shows tasks)
        const OrderDetails = ({ order, bakerName, onUpdateTask }) => {
          const getStatusColor = (status) => {
            switch (status) {
              case 'New': return 'bg-gray-200 text-gray-800 dark:bg-gray-700 dark:text-gray-200';
              case 'In Progress': return 'bg-yellow-200 text-yellow-800 dark:bg-yellow-700 dark:text-yellow-200';
              case 'Completed': return 'bg-green-200 text-green-800 dark:bg-green-700 dark:text-green-200';
              default: return 'bg-gray-200 text-gray-800 dark:bg-gray-700 dark:text-gray-200';
            }
          };

          const statusEmojis = {
            'New': 'ðŸ†•',
            'In Progress': 'â³',
            'Completed': 'âœ…'
          };
          
          const [showCustomModal, setShowCustomModal] = useState(false);
          const [customModalMessage, setCustomModalMessage] = useState('');

          const handleClaim = (taskId) => {
            if (bakerName.trim() === '') {
              setCustomModalMessage("Please enter your name at the top to claim a task!");
              setShowCustomModal(true);
              return;
            }
            onUpdateTask(order.id, taskId, 'In Progress', bakerName);
          };

          const handleComplete = (taskId) => {
            onUpdateTask(order.id, taskId, 'Completed', bakerName);
          };

          const handleUnassign = (taskId) => {
            onUpdateTask(order.id, taskId, 'New', '');
          };

          return (
            <div className="p-6">
              <h3 className="text-2xl font-bold text-gray-800 dark:text-gray-200 mb-2">{order.customerName}'s Order</h3>
              <p className="text-sm text-gray-500 dark:text-gray-400 mb-6">Due: {new Date(order.dueDate).toLocaleDateString()} at {order.dueTime}</p>
              
              <div className="space-y-4">
                {(order.tasks || []).length === 0 ? (
                  <p className="text-center text-gray-500 dark:text-gray-400">No tasks for this order.</p>
                ) : (
                  (order.tasks || []).map((task) => (
                    <div key={task.id} className="bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm border border-gray-200 dark:border-gray-700">
                      <div className="flex justify-between items-center mb-2">
                        <p className="font-semibold text-gray-800 dark:text-gray-200">{task.taskName}</p>
                        <span className={`inline-flex items-center rounded-full px-3 py-1 text-xs font-semibold ${getStatusColor(task.status)}`}>
                          {statusEmojis[task.status]} {task.status}
                        </span>
                      </div>
                      {task.assignedBaker && (
                        <p className="text-sm text-gray-600 dark:text-gray-400">Assigned to: <span className="font-bold text-rose-500">{task.assignedBaker}</span></p>
                      )}
                      <div className="mt-4 flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2">
                        {task.status === 'New' && (
                          <button
                            onClick={() => handleClaim(task.id)}
                            className="flex-1 bg-sky-500 hover:bg-sky-600 text-white font-bold py-2 px-4 rounded-full shadow-md transition duration-200"
                          >
                            Claim Task
                          </button>
                        )}
                        {task.status === 'In Progress' && task.assignedBaker === bakerName && (
                          <button
                            onClick={() => handleComplete(task.id)}
                            className="flex-1 bg-green-500 hover:bg-green-600 text-white font-bold py-2 px-4 rounded-full shadow-md transition duration-200"
                          >
                            Mark as Completed
                          </button>
                        )}
                        {task.status === 'In Progress' && task.assignedBaker === bakerName && (
                          <button
                            onClick={() => handleUnassign(task.id)}
                            className="flex-1 bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded-full shadow-md transition duration-200"
                          >
                            Unassign
                          </button>
                        )}
                      </div>
                    </div>
                  ))
                )}
              </div>
              {/* Custom Alert/Message Modal for OrderDetails */}
              {showCustomModal && (
                <Modal onClose={() => setShowCustomModal(false)}>
                  <div className="p-6 text-center">
                    <p className="text-xl font-semibold text-gray-800 dark:text-gray-200">{customModalMessage}</p>
                    <button
                      onClick={() => setShowCustomModal(false)}
                      className="mt-6 bg-rose-500 hover:bg-rose-600 text-white font-bold py-2 px-4 rounded-full shadow-lg transition duration-200"
                    >
                      OK
                    </button>
                  </div>
                </Modal>
              )}
            </div>
          );
        };

        // Generic Modal Component
        const Modal = ({ children, onClose }) => {
          return (
            <div className="fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center p-4 z-50">
              <div className="bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-6 w-full max-w-lg relative max-h-screen overflow-y-auto">
                <button
                  onClick={onClose}
                  className="absolute top-4 right-4 text-gray-400 hover:text-gray-600 dark:text-gray-600 dark:hover:text-gray-400"
                >
                  <svg xmlns="http://www.w3.org/2000/svg" className="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path strokeLinecap="round" strokeWidth={2} d="M6 18L18 6M6 6l12 12" />
                  </svg>
                </button>
                {children}
              </div>
            </div>
          );
        };

        // Render the App component into the root div
        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<App />);
    </script>
</body>
</html>
